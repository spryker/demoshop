function postForm(e,t,n){var i={};$.each(e.serializeArray(),function(e,t){i[t.name]=t.value}),$.ajax({type:e.attr("method"),url:"?id-page="+$("#idPage").val()+"&id-form="+t,data:i,success:function(e){n(e)}})}function showAutoComplete(e,t){var n='<div id="foundKeyListContainer" class="key-container"><select id="foundKeyList" size="10" class="key-list"></select></div>';$(".keyListCanvas").empty(),$(".keyListCanvas").append(n),keyList=$("#foundKeyList"),keyContainer=$("#foundKeyListContainer");var i=$(".form_class_"+e),a=i.find("#form_glossary_key"),o=i.find("#form_translation"),s=1==t?"search/?key=":"search/?value=";keyList.find("option").remove(),$(".loading-"+e).show(),xhr=$.ajax({type:"GET",url:s+a.val(),success:function(t){$(".loading-"+e).hide(),$.each(t,function(e,t){keyList.append($("<option>",{value:e,text:t.key})),keyContainer.css({top:a.offset().top-137}),keyContainer.css({left:a.offset().left-230}),keyContainer.css({width:a.width()+25}),keyContainer.show()}),keyList.css({height:17*t.length}),keyList.on("change",function(){o.text(t[this.value].value),a.val(t[this.value].key)}),keyList.on("keydown",function(e){var t=e.keyCode;return 13==t||9==t?(keyList.blur(),!1):void 0}),keyList.on("blur",function(){return a.val(t[this.value].key),keyContainer.hide(),a.focus(),!1})}})}var xhr=null,keyList=null,keyContainer=null,ajaxifySubmmit=function(e){$(".form_class_"+e).submit(function(t){return t.preventDefault(),$(".waiting_"+e).text("Waiting ..."),$(".success_"+e).text(""),$(".error_"+e).text(""),postForm($(this),e-1,function(t){$(".waiting_"+e).text(""),"false"!=t.success?$(".success_"+e).text("Successfully added."):$(".error_"+e).text(t.errorMessages)}),!1})},addKeySearchEvent=function(e){var t=$(".form_class_"+e),n=t.find("#form_glossary_key"),i=t.find("#form_search_option");n.on("input",function(){$(this).val().length>3&&delay(function(){xhr&&4!=xhr.readystate&&xhr.abort(),0!=i.val()&&showAutoComplete(e,i.val())},500)}),n.on("keyup",function(e){var t=e.keyCode;40==t&&(keyList.first().focus(),keyList.val(0).change())})},delay=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}();$(document).ready(function(){$(".cms_form").each(function(e,t){var n=$(t).attr("data-index");ajaxifySubmmit(n),addKeySearchEvent(n)})}),$(document).on("click",function(e){null===keyContainer||$(e.target).is("option")||keyContainer.hide()});